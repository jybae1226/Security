<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <title>Security Mechanisms – 4G and 5G</title>
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <link rel="stylesheet" href="style.css" />
</head>
<body>
  <header>
    <div class="nav-inner">
      <div class="logo">4G / 5G Security</div>
      <nav>
        <ul>
          <li><a href="index.html">Overview</a></li>
          <li><a href="introduction.html">Introduction</a></li>
          <li><a href="mechanisms.html" class="active">Security Mechanisms</a></li>
          <li><a href="attacks.html">Attacks &amp; Feasibility</a></li>
          <li><a href="opinions.html">Opinion &amp; Conclusion</a></li>
          <li><a href="references.html">References</a></li>
        </ul>
      </nav>
    </div>
  </header>

  <main>
    <section class="hero">
      <h1>2. Security Architecture &amp; Mechanisms</h1>
      <p>
        This page summarizes how 4G and 5G secure subscriber identity, authenticate devices and networks, 
        derive cryptographic keys, and protect signaling and user data. It first explains the main 
        security mechanisms in 4G (LTE), then describes new mechanisms introduced in 5G, and finally 
        highlights concepts that are common to both generations.
      </p>
    </section>

    <section>
      <h3>2.1 Security Mechanisms in 4G (LTE)</h3>

      <h4>2.1.1 EPS-AKA: Authentication and Key Agreement</h4>
      <p>
        EPS-AKA (Evolved Packet System Authentication and Key Agreement) is the main authentication 
        protocol used in 4G/LTE networks. It provides mutual authentication between the User Equipment (UE), 
        the serving network, and the home network, and it establishes fresh cryptographic keys for later use.
      </p>

      <p><strong>Basic roles.</strong></p>
      <ul>
        <li><strong>UE:</strong> the user’s device together with the USIM card, which stores a long-term secret key.</li>
        <li><strong>Home Subscriber Server (HSS):</strong> a core network element that stores subscriber identities and long-term keys.</li>
        <li><strong>Serving network:</strong> the local network currently providing service to the UE.</li>
      </ul>

      <p><strong>How it works (principle).</strong></p>
      <ul>
        <li>The serving network requests an authentication vector from the HSS for a given subscriber.</li>
        <li>
          The HSS generates a random challenge (RAND), an expected response (XRES), a cipher key (CK), 
          an integrity key (IK), and an authentication token (AUTN) using the long-term key shared 
          with the USIM.
        </li>
        <li>The serving network sends RAND and AUTN to the UE.</li>
        <li>The USIM verifies AUTN to authenticate the network and ensure the challenge is fresh (replay protection).</li>
        <li>If verification succeeds, the USIM computes a response RES and sends it back.</li>
        <li>The serving network compares RES with XRES; if they match, the UE is authenticated.</li>
        <li>From CK and IK, the network derives further keys such as K<sub>ASME</sub> for signaling and radio encryption.</li>
      </ul>

      <p><strong>Why it matters.</strong></p>
      <p>
        EPS-AKA protects against impersonation of both the subscriber and the network and enables secure 
        key establishment without revealing the long-term secret key. However, attackers can still exploit 
        weaknesses in early stages of the attachment procedure or in how authentication is triggered, 
        for example by using fake base stations to repeatedly force authentication attempts.
      </p>

      <hr />

      <h4>2.1.2 Radio Interface Security: NAS and RRC Ciphering and Integrity</h4>
      <p>
        4G protects signaling and, optionally, user data over the radio interface using two protocol layers:
      </p>
      <ul>
        <li>
          <strong>Non-Access Stratum (NAS):</strong> signaling between the UE and the core network 
          (attach, detach, tracking area update, etc.).
        </li>
        <li>
          <strong>Radio Resource Control (RRC):</strong> signaling between the UE and the base station (eNodeB) 
          to configure radio bearers, handovers, and related functions.
        </li>
      </ul>
      <p>
        Both NAS and RRC can be protected with ciphering (encryption) and integrity protection 
        (message authentication).
      </p>

      <p><strong>How it works.</strong></p>
      <ul>
        <li>After EPS-AKA, the UE and network share the master key K<sub>ASME</sub>.</li>
        <li>
          From K<sub>ASME</sub>, the network derives NAS keys (K<sub>NASenc</sub>, K<sub>NASint</sub>) and later 
          RRC and user-plane keys (K<sub>eNB</sub>, then K<sub>RRC</sub>, K<sub>UP</sub>, etc.).
        </li>
        <li>
          Encryption algorithms such as AES-based or SNOW 3G-based ciphers protect confidentiality 
          of signaling and user data.
        </li>
        <li>
          Integrity algorithms compute a Message Authentication Code (MAC) over signaling messages 
          so that any tampering can be detected.
        </li>
      </ul>

      <p><strong>Why it matters.</strong></p>
      <p>
        Radio interface security prevents passive eavesdropping and active manipulation by attackers 
        listening on the air interface. However, messages sent before security activation, and 
        misconfigurations where integrity protection is not enforced, have enabled practical attacks 
        that affect privacy or availability.
      </p>

      <hr />

      <h4>2.1.3 Network Domain Security (NDS/IPsec) in the Core</h4>
      <p>
        Within the operator’s core network, communication between elements such as the MME, SGW, and PGW 
        often runs over IP networks. Network Domain Security (NDS) defines how to protect these internal 
        links using IPsec tunnels, a standard mechanism for authenticating and encrypting IP traffic.
      </p>

      <p><strong>How it works.</strong></p>
      <ul>
        <li>Security Gateways (SEGs) establish IPsec Security Associations (SAs) using Internet Key Exchange (IKE).</li>
        <li>
          Once SAs are established, IPsec in Encapsulating Security Payload (ESP) mode provides encryption and 
          integrity for all traffic between protected domains.
        </li>
        <li>
          Security policies determine which traffic must be protected, such as signaling between MMEs and HSS 
          or between core nodes in different data centers.
        </li>
      </ul>

      <p><strong>Why it matters.</strong></p>
      <p>
        NDS/IPsec reduces the risk that an attacker inside the operator’s IP network can intercept or modify 
        core signaling. Misconfigured or unprotected interfaces, especially toward third-party networks or 
        roaming partners, nonetheless remain an important source of vulnerabilities.
      </p>
    </section>

    <section>
      <h3>2.2 Security Mechanisms in 5G</h3>

      <h4>2.2.1 5G-AKA and EAP-AKA′</h4>
      <p>
        5G introduces an updated authentication framework with two main options: 5G-AKA and EAP-AKA′. 
        Both provide mutual authentication and key agreement between the UE, the Serving Network (SN), 
        and the Home Network (HN), with improved handling of roaming and stronger control by the home network.
      </p>

      <p><strong>Key concepts.</strong></p>
      <ul>
        <li><strong>EAP (Extensible Authentication Protocol):</strong> a generic framework used in many systems, including Wi-Fi.</li>
        <li>
          <strong>EAP-AKA′:</strong> an EAP method that reuses AKA but with additional protections against specific 
          previously known attacks.
        </li>
      </ul>

      <p><strong>How it works (high level).</strong></p>
      <ul>
        <li>The UE and home network still share a long-term key in the USIM.</li>
        <li>The authentication exchange runs either as 5G-AKA (a 3GPP-specific protocol) or as EAP-AKA′ carried in NAS messages.</li>
        <li>The home network has explicit control over authentication decisions and can more strongly bind the security context to the serving network identity.</li>
        <li>The result is a master key K<sub>SEAF</sub>, from which keys for NAS, RRC, user plane, and service-based interfaces are derived.</li>
      </ul>

      <p><strong>Why it matters.</strong></p>
      <p>
        5G-AKA and EAP-AKA′ address limitations of LTE EPS-AKA, such as certain identity misbinding issues 
        and weaknesses in roaming scenarios. They also integrate better with other EAP-based environments. 
        Nonetheless, correct implementation in both USIMs and network elements is crucial, and several 
        theoretical weaknesses and privacy questions are still researched.
      </p>

      <hr />

      <h4>2.2.2 Subscriber Identity Protection: SUPI and SUCI</h4>
      <p>
        In LTE, the permanent subscriber identity (IMSI) can sometimes be exposed over the air, enabling 
        IMSI-catcher attacks. 5G introduces two related concepts:
      </p>
      <ul>
        <li><strong>SUPI (Subscription Permanent Identifier):</strong> the long-term subscriber identity, similar to the IMSI.</li>
        <li><strong>SUCI (Subscription Concealed Identifier):</strong> a public-key-encrypted form of the SUPI that is sent over the radio interface.</li>
      </ul>

      <p><strong>How it works.</strong></p>
      <ul>
        <li>Each home network publishes a public key used for identity concealment.</li>
        <li>The UE’s USIM encrypts the SUPI with this public key and generates the SUCI before transmission.</li>
        <li>Only the home network, which holds the corresponding private key, can recover the original SUPI.</li>
        <li>After registration, temporary identifiers (such as 5G-GUTI) are used for efficiency and additional privacy.</li>
      </ul>

      <p><strong>Why it matters.</strong></p>
      <p>
        SUCI significantly raises the bar for passive attackers attempting to track users by collecting 
        long-term identifiers over the air. However, active attackers operating fake base stations may 
        still exploit other protocol behaviors or insufficient refresh of temporary identifiers, so 
        additional privacy measures and careful operational practices remain important.
      </p>

      <hr />

      <h4>2.2.3 Service-Based Architecture (SBA) Security and SEPP</h4>
      <p>
        The 5G Core (5GC) adopts a Service-Based Architecture (SBA) in which core functions expose HTTP/2 
        and JSON APIs to one another, called Service-Based Interfaces (SBI). To secure these interfaces, 
        5G uses common IT security mechanisms such as TLS, mutual authentication, and authorization tokens. 
        For communication between operators, 5G introduces the Security Edge Protection Proxy (SEPP).
      </p>

      <p><strong>Key concepts.</strong></p>
      <ul>
        <li><strong>TLS (Transport Layer Security):</strong> protocol providing encryption and authentication for TCP connections.</li>
        <li>
          <strong>SEPP:</strong> a gateway that protects signaling on the N32 interface between different operators’ 5G cores, 
          adding integrity and confidentiality for selected message fields.
        </li>
      </ul>

      <p><strong>How it works.</strong></p>
      <ul>
        <li>Each Network Function (NF) authenticates to others using certificates issued by a trusted PKI or local CA.</li>
        <li>HTTP requests on the SBI are protected by TLS, and access control is enforced based on NF identities and authorization policies.</li>
        <li>When messages cross operator boundaries, SEPPs on both sides sign and selectively encrypt parts of the signaling so that only authorized entities can read or modify them.</li>
      </ul>

      <p><strong>Why it matters.</strong></p>
      <p>
        Using well-known web security mechanisms helps bridge telecom and IT security and allows reuse of mature tools. 
        At the same time, it introduces familiar web-style risks: misconfigured TLS, poor certificate management, 
        and vulnerable APIs. Research shows that improper deployment of SBA can create serious vulnerabilities 
        even if the specifications themselves are sound.
      </p>
    </section>

    <section>
      <h3>2.3 Security Mechanisms Common to Both 4G and 5G</h3>

      <h4>2.3.1 Hierarchical Key Management</h4>
      <p>
        Both 4G and 5G use a hierarchical key management scheme:
      </p>
      <ul>
        <li>A long-term key in the USIM, shared only with the home network.</li>
        <li>An intermediate master key derived during AKA (K<sub>ASME</sub> in LTE, K<sub>SEAF</sub> in 5G).</li>
        <li>Separate keys for NAS, RRC, and user-plane traffic, and in some cases per-bearer keys.</li>
      </ul>
      <p>
        This hierarchy limits damage if a single radio connection key is compromised, since the attacker 
        should not gain access to the master or long-term keys. It also enables re-keying during mobility 
        and handovers without re-running full authentication.
      </p>

      <h4>2.3.2 Use of Standardized Cryptographic Algorithms</h4>
      <p>
        Both generations rely on standardized cryptographic algorithms that have been reviewed by 3GPP and 
        external experts, for example AES-based stream ciphers and integrity algorithms. In practice, most 
        vulnerabilities stem from protocol design, implementation bugs, or configuration errors rather than 
        from the underlying cryptographic primitives.
      </p>
    </section>
  </main>

  <footer>
    <p class="muted">
      &copy; 2025 JongYeon Bae — Security in 4G / 5G Mobile Networks.
    </p>
  </footer>
</body>
</html>
